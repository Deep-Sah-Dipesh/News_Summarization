2025-11-18 05:00:09,365 [INFO] - --- Starting Multimodal 65000 Balanced Dataset Build (from Extracted Files) ---
2025-11-18 05:00:09,370 [INFO] - Source Dirs: ['D:\\Articles\\extracted_articles\\bbc_1\\bbcnews_json', 'D:\\Articles\\extracted_articles\\bbc_2\\bbcnews_stm2json']
2025-11-18 05:00:09,370 [INFO] - Output Dir: H:\News_Summarization\Dataset\News_Articles_with_Images\diverse65kdataset_balanced
2025-11-18 05:00:09,370 [INFO] - Target Total Size: 65000
2025-11-18 05:00:09,370 [INFO] - Using 32 parallel download workers.
2025-11-18 05:00:09,675 [INFO] - Loading EasyOCR model...
2025-11-18 05:00:11,836 [INFO] - EasyOCR model loaded successfully on GPU.
2025-11-18 05:00:11,836 [INFO] - Scanning all source directories for .json files... (This may take a while)
2025-11-18 05:00:11,836 [INFO] - Scanning directory: D:\Articles\extracted_articles\bbc_1\bbcnews_json
2025-11-18 05:00:13,169 [INFO] - Found 312118 .json files in D:\Articles\extracted_articles\bbc_1\bbcnews_json.
2025-11-18 05:00:13,169 [INFO] - Scanning directory: D:\Articles\extracted_articles\bbc_2\bbcnews_stm2json
2025-11-18 05:00:13,795 [INFO] - Found 160605 .json files in D:\Articles\extracted_articles\bbc_2\bbcnews_stm2json.
2025-11-18 05:00:13,795 [INFO] - Found 472723 total processable files across 2 sources.
2025-11-18 05:00:13,795 [INFO] - Saving file list cache to H:\News_Summarization\Dataset\News_Articles_with_Images\diverse65kdataset_balanced\_file_scan_cache.json...
2025-11-18 05:00:15,709 [INFO] - Creating a balanced dataset of 65000 total samples from 472723 files.
2025-11-18 05:00:15,709 [INFO] - Taking 42916 random samples from D:\Articles\extracted_articles\bbc_1\bbcnews_json (Ratio: 66.03%)
2025-11-18 05:00:15,911 [INFO] - Taking 22083 random samples from D:\Articles\extracted_articles\bbc_2\bbcnews_stm2json (Ratio: 33.97%)
2025-11-18 05:00:16,042 [INFO] - Total files to process after sampling: 64999
2025-11-18 05:00:16,044 [INFO] - Stage 1: Reading JSON files and submitting download jobs...
2025-11-18 05:00:21,128 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='c.files.bbci.co.uk', port=80): Read timed out. (read timeout=5)")': /8054/production/_87125823_56f755bf-9783-4d3b-8d67-07b3996eb651.jpg
2025-11-18 05:00:21,128 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='c.files.bbci.co.uk', port=80): Read timed out. (read timeout=5)")': /DE1C/production/_88206865_teensphones.jpg
2025-11-18 05:00:21,128 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='c.files.bbci.co.uk', port=80): Read timed out. (read timeout=5)")': /80EB/production/_83730033_014706434-1.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/44965000/jpg/_44965808_-2.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/48137000/jpg/_48137020_48137009.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/77844000/jpg/_77844460_77844459.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/49316000/jpg/_49316925__47136318_craig_perks-1.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/55765000/jpg/_55765476_009152305-1.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/72682000/jpg/_72682628_spencer.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/65887000/jpg/_65887552_firstsingledecker-adlenviro300.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/48566000/jpg/_48566472_mispersylwia.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/49737000/jpg/_49737538_sheridans.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/51365000/jpg/_51365384_bhpozpic.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/48055000/jpg/_48055815_m575042-surgeons_peform_liver_transplant_operatio-spl-1.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/46454000/jpg/_46454857_jex_468080_de27-1.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/46173000/jpg/_46173559_007760708-1.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/45894000/jpg/_45894498_haverigg.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/41230000/jpg/_41230239_callcentre2203.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/44010000/jpg/_44010293_jossstone203b.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/40891000/jpg/_40891490_breast_tumour203.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/47482000/jpg/_47482942_sellman.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/55868000/jpg/_55868980_55868979.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/46650000/jpg/_46650684_brown466x282.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/41757000/jpg/_41757112_gurney_ap_203b.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/42775000/jpg/_42775939_krystalhart203.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/44016000/jpg/_44016850_oyebola_pa203b.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/45457000/jpg/_45457434_kate_pa226b.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/45393000/jpg/_45393146_munn226.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/45166000/jpg/_45166819_5fd209de-e447-454c-8e22-f000fe79058d.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='news.bbcimg.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/74184000/jpg/_74184679_8a8a96ef-a7a8-43a4-973c-5a7a9f63a652.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/44758000/jpg/_44758225_sachina.jpg
2025-11-18 05:00:21,227 [WARNING] - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPConnectionPool(host='newsimg.bbc.co.uk', port=80): Read timed out. (read timeout=5)")': /media/images/43059000/jpg/_43059563_iberia_afp203b.jpg
2025-11-18 05:00:28,535 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47146000/jpg/_47146362_jex_577020_de03-1.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47146000/jpg/_47146362_jex_577020_de03-1.jpg
2025-11-18 05:00:33,538 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47040000/jpg/_47040592_jex_563381_de03-1.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47040000/jpg/_47040592_jex_563381_de03-1.jpg
2025-11-18 05:00:53,305 [INFO] - Submitted 25446 image download jobs.
2025-11-18 05:00:53,305 [INFO] - Stage 2: Downloading and processing images (OCR)...
2025-11-18 05:00:57,155 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/45801000/jpg/_45801550_rantzen_pa226.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/45801000/jpg/_45801550_rantzen_pa226.jpg
2025-11-18 05:00:58,835 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47315000/jpg/_47315859_jex_6730_de27-1.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47315000/jpg/_47315859_jex_6730_de27-1.jpg
2025-11-18 05:01:00,984 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44034000/jpg/_44034853_manbelly203spl.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44034000/jpg/_44034853_manbelly203spl.jpg
2025-11-18 05:01:11,725 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44662000/gif/_44662852_dummies226.gif: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44662000/gif/_44662852_dummies226.gif
2025-11-18 05:01:18,074 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/46844000/jpg/_46844701_-11.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/46844000/jpg/_46844701_-11.jpg
2025-11-18 05:01:19,385 [WARNING] - Failed to download image http://news.bbcimg.co.uk/media/images/48202000/jpg/_48202959_murrymatchday7still.jpg: 404 Client Error: Not Found for url: http://news.bbcimg.co.uk/media/images/48202000/jpg/_48202959_murrymatchday7still.jpg
2025-11-18 05:01:21,899 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44752000/jpg/_44752630_poochap.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44752000/jpg/_44752630_poochap.jpg
2025-11-18 05:01:36,059 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44041000/jpg/_44041073_dandopa203b.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44041000/jpg/_44041073_dandopa203b.jpg
2025-11-18 05:01:41,220 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47171000/jpg/_47171799_rooney226.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47171000/jpg/_47171799_rooney226.jpg
2025-11-18 05:01:41,611 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44039000/jpg/_44039087_brixton_shootingmap300.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44039000/jpg/_44039087_brixton_shootingmap300.jpg
2025-11-18 05:01:47,604 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/45938000/jpg/_45938296_canyon_presser_512.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/45938000/jpg/_45938296_canyon_presser_512.jpg
2025-11-18 05:02:07,764 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47234000/jpg/_47234658_008505928-3.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47234000/jpg/_47234658_008505928-3.jpg
2025-11-18 05:02:09,941 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47533000/jpg/_47533218_hargan.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47533000/jpg/_47533218_hargan.jpg
2025-11-18 05:02:12,855 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44854000/jpg/_44854753_-2.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44854000/jpg/_44854753_-2.jpg
2025-11-18 05:02:26,684 [WARNING] - Failed to download image http://news.bbcimg.co.uk/media/images/47043000/jpg/_47043224_vaughan_av512.jpg: 404 Client Error: Not Found for url: http://news.bbcimg.co.uk/media/images/47043000/jpg/_47043224_vaughan_av512.jpg
2025-11-18 05:02:26,965 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/46557000/jpg/_46557142_80740790.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/46557000/jpg/_46557142_80740790.jpg
2025-11-18 05:02:27,157 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/45932000/jpg/_45932014_jex_1399_de27.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/45932000/jpg/_45932014_jex_1399_de27.jpg
2025-11-18 05:02:37,903 [WARNING] - Failed to download image http://news.bbcimg.co.uk/media/images/82819000/jpg/_82819656_82819654.jpg: 404 Client Error: Not Found for url: http://news.bbcimg.co.uk/media/images/82819000/jpg/_82819656_82819654.jpg
2025-11-18 05:02:44,283 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44039000/jpg/_44039861_seizedguns_ap203b.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44039000/jpg/_44039861_seizedguns_ap203b.jpg
2025-11-18 05:02:54,493 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47038000/jpg/_47038395_trembling_512.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47038000/jpg/_47038395_trembling_512.jpg
2025-11-18 05:02:57,033 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/44040000/jpg/_44040615_housebuild_bbc.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/44040000/jpg/_44040615_housebuild_bbc.jpg
2025-11-18 05:03:31,109 [WARNING] - Failed to download image http://news.bbcimg.co.uk/media/images/45562000/jpg/_45562562_000040386-1.jpg: 404 Client Error: Not Found for url: http://news.bbcimg.co.uk/media/images/45562000/jpg/_45562562_000040386-1.jpg
2025-11-18 05:03:35,138 [WARNING] - Failed to download image http://newsimg.bbc.co.uk/media/images/47403000/jpg/_47403280_jex_5573_de57-1.jpg: 404 Client Error: Not Found for url: http://newsimg.bbc.co.uk/media/images/47403000/jpg/_47403280_jex_5573_de57-1.jpg
2025-11-18 05:13:17,465 [INFO] - Script finished or was interrupted.
2025-11-18 05:13:17,465 [INFO] - Successfully processed 25421 items.
2025-11-18 05:13:17,465 [INFO] - Converting to DataFrame and saving to H:\News_Summarization\Dataset\News_Articles_with_Images\diverse65kdataset_balanced\multimodal_diverse65kdataset_20251118.parquet...
2025-11-18 05:13:18,495 [INFO] - --- 25421 Balanced Dataset Build Complete! ---
2025-11-18 05:13:18,495 [INFO] - Final dataset saved to H:\News_Summarization\Dataset\News_Articles_with_Images\diverse65kdataset_balanced\multimodal_diverse65kdataset_20251118.parquet
